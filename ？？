#include<bits/stdc++.h> 

using namespace std;

struct node {
	char st[25];
	int num;
	int tot;
} a[1010];

int n,m,g;

bool compare(node a,node b) {
	//if(x.tot=!y.tot) return x.tot>y.tot;
	//return x.st<y.st;
    if(a.tot!=b.tot) return a.tot>b.tot;
    return (strcmp(a.st>b.st)>0)?0:1;
}

int main() {
	while(scanf("%d",&n),n) {
		//if(!n) break;
		scanf("%d%d",&m,&g);
		int nlev=0;
		int sc[15];
		for(int i=1;i<=m;i++) {
			scanf("%d",&sc[i]);
		}
		//cout<<sc[1]<<endl;
		for(int i=1;i<=n;i++) {
			scanf("%s",&a[i].st);
			scanf("%d",&a[i].num);
			a[i].tot=0;
			for(int j=1;j<=a[i].num;j++) {
				int cnt;	
				scanf("%d",&cnt);
				a[i].tot+=sc[cnt];
			}
			//cout<<a[i].tot<<endl;
			if(a[i].tot>=g) nlev++;
		}
		printf("%d\n",nlev);
		sort(a+1,a+n+1,compare);
		for(int i=1;i<=n;i++) {
			if(a[i].tot<g) break;
			printf("%s %d\n",a[i].st,a[i].tot);
		}
	}
	return 0;
}
